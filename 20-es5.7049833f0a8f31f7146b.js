!function(){function e(){var i=c(['\n  mutation CreateVisitor(\n    $visitorInsertObject: visitor_insert_input! = { visitor_first_name: "", visitor_last_name: "", visitor_phone: "", visitor_email: "" }\n  ) {\n    insert_visitor_one(\n      object: $visitorInsertObject\n      on_conflict: { constraint: visitor_visitor_first_name_visitor_last_name_visitor_phone__key, update_columns: updated_at }\n    ) {\n      visitor_uuid\n    }\n  }\n']);return e=function(){return i},i}function i(e,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function n(){var e=c(['\n  query PlaceDetails($placeUUIDEquals: uuid! = "875b4319-5b1c-44ef-9950-bc6004c4f77a") {\n    place(where: { place_uuid: { _eq: $placeUUIDEquals } }, distinct_on: place_uuid) {\n      business_name\n      place_name\n      place_description\n      place_capacity\n      place_address\n      place_stay_estimate_minutes\n    }\n  }\n']);return n=function(){return e},e}function o(){var e=c(['\n  subscription PlaceVisitorsCurrentCount($placeUUIDEquals: uuid! = "") {\n    visit_aggregate(\n      where: {\n        _and: { place_uuid: { _eq: $placeUUIDEquals }, checked_out_at: { _is_null: true }, checked_in_at: { _is_null: false } }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n  }\n']);return o=function(){return e},e}function c(e,i){return i||(i=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(i)}}))}function a(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{CbZG:function(i,c,r){"use strict";r.r(c),r.d(c,"VisitorPageModule",(function(){return j}));var s=r("SVse"),l=r("s7LF"),u=r("sZkV"),b=r("iInd"),d=r("pLZG"),m=r("lJxs"),v=function e(){return a(this,e),new l.d({visitor_first_name:new l.b("",[l.m.required,l.m.minLength(1)]),visitor_last_name:new l.b("",[l.m.required,l.m.minLength(1)]),visitor_phone:new l.b("",[l.m.required,l.m.minLength(10)]),visitor_email:new l.b("",l.m.compose([l.m.required,l.m.pattern("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$")]))})},h=r("8Y7J"),p=r("9Ku7"),f=r("apZm"),g=r("ALmS"),k=r("nbgS");g.gql(o());var _,I,y=g.gql(n()),D=((_=function(){function e(i){a(this,e),this.apollo=i}return t(e,[{key:"getPlaceDetails",value:function(e){return this.apollo.query({query:y,variables:{placeUUIDEquals:e}})}}]),e}()).\u0275fac=function(e){return new(e||_)(h.Rb(k.b))},_.\u0275prov=h.Eb({token:_,factory:_.\u0275fac,providedIn:"root"}),_),U=g.gql(e()),C=((I=function(){function e(i){a(this,e),this.apollo=i}return t(e,[{key:"createVisitor",value:function(e){var i=e.visitor_first_name,t=e.visitor_last_name,n=e.visitor_phone,o=e.visitor_email;return this.apollo.mutate({mutation:U,variables:{visitorInsertObject:{visitor_first_name:i,visitor_last_name:t,visitor_phone:n,visitor_email:o}},errorPolicy:"all"})}}]),e}()).\u0275fac=function(e){return new(e||I)(h.Rb(k.b))},I.\u0275prov=h.Eb({token:I,factory:I.\u0275fac,providedIn:"root"}),I);function M(e,i){if(1&e&&(h.Lb(0),h.nc(1),h.Yb(2,"async"),h.Yb(3,"date"),h.Kb()),2&e){var t,n=h.Xb();h.yb(1),h.qc(" Thank you for checking in to ",null==(t=h.Zb(2,2,n.placeDetails))?null:t.place_name," ",h.ac(3,4,n.checkedInDateTime,"EEEE hh:mm:ss aaaa")," ")}}function O(e,i){if(1&e){var t=h.Ob();h.Nb(0,"ion-button",20),h.Vb("click",(function(e){return h.ic(t),h.Xb().clickCheckIn(e)})),h.Jb(1,"ion-icon",21),h.nc(2),h.Yb(3,"date"),h.Mb()}if(2&e){var n=h.Xb();h.dc("disabled",void 0===n.visitorUUIDForCheckin),h.yb(2),h.pc(" Check in ",h.ac(3,2,n.todayNow,"EEEE d MMMM yyyy")," ")}}function N(e,i){if(1&e&&(h.Lb(0),h.nc(1),h.Yb(2,"date"),h.Kb()),2&e){var t=h.Xb();h.yb(1),h.pc(" Thank you for checking out at ",h.ac(2,1,t.checkedInDateTime,"hh:mm:ss aaaa")," ")}}function w(e,i){if(1&e){var t=h.Ob();h.Nb(0,"ion-button",22),h.Vb("click",(function(e){return h.ic(t),h.Xb().clickCheckOut(e)})),h.nc(1),h.Yb(2,"date"),h.Jb(3,"ion-icon",23),h.Mb()}if(2&e){var n=h.Xb();h.dc("disabled",void 0===n.checkedInDateTime||void 0===n.visitorUUIDForCheckin)("color",n.checkedInDateTime?"success":"primary"),h.yb(1),h.pc(" Check out ",n.checkedInDateTime?h.ac(2,3,n.clockTime,"hh:mm:ss aaaa"):""," ")}}function F(e){console.log("VisitorPage:: getVisitorFieldsFromParamMap -> paramMap",e);var i=e.params;return console.log("VisitorPage:: extractHotlinkedVisitorParams -> unsafeExtractionObject",i),function(e){return{visitor_first_name:e.firstName,visitor_last_name:e.lastName,visitor_email:e.email,visitor_phone:e.phone}}(i)}var P,T,V,S=[{path:"",component:(P=function(){function e(i,t,n,o,c,r){var s,l,u=this;a(this,e),this.activatedRoute=i,this.authenticationService=t,this.formBuilder=n,this.checkInOutService=o,this.placeService=c,this.visitorService=r,this.todayNow=new Date,this.clockTime=new Date,this.placeUUID=i.snapshot.paramMap.get("placeUUID"),console.log("VisitorPage -> constructor -> this.placeUUID",this.placeUUID),this.visitorForm=new v,this.visitorForm.valueChanges.subscribe((function(e){console.log("VisitorPage -> valueChanges",e,u.visitorForm)})),(s=i,l=s.paramMap,console.log("VisitorPage:: activatedRouteParamMap",l),l.pipe(Object(m.a)(F))).subscribe((function(e){console.log("VisitorPage -> constructor -> extractedVisitor",e),u.visitorForm.patchValue(e)}));var b=c.getPlaceDetails("875b4319-5b1c-44ef-9950-bc6004c4f77a");b.subscribe((function(e){var i=e.data,t=e.error,n=e.errors,o=e.loading,c=e.networkStatus,a=e.partial;console.log("VisitorPage:: getPlaceDetails() -> error",t,n,o,c,a),console.log("VisitorPage:: getPlaceDetails() -> data",i)}));var h=b.pipe(Object(d.a)((function(e){var i,t;return void 0!==(null===(t=null===(i=e.data)||void 0===i?void 0:i.place)||void 0===t?void 0:t[0])})),Object(m.a)((function(e){return e.data.place[0]})));this.placeDetails=h,this.placeDeets=c.getPlaceDetails("875b4319-5b1c-44ef-9950-bc6004c4f77a"),this.clockTimeIntervalID=this.getClockTimeUpdaterGranularSecond()}return t(e,[{key:"ngOnInit",value:function(){}},{key:"getClockTimeUpdaterGranularSecond",value:function(){var e=this;return setInterval((function(){e.clockTime=new Date}),1e3)}},{key:"ngOnDestroy",value:function(){clearInterval(this.clockTimeIntervalID)}},{key:"submitForm",value:function(e){var i=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.visitorForm,n=t.invalid,o=t.value,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.visitorService;console.log("VisitorPage -> submitForm -> event",e),n||c.createVisitor(o).subscribe((function(e){var t,n;console.log("VisitorPage -> submitForm -> visitorResult",e),i.visitorUUIDForCheckin=null===(n=null===(t=e.data)||void 0===t?void 0:t.insert_visitor_one)||void 0===n?void 0:n.visitor_uuid}))}},{key:"clickCheckIn",value:function(e){var i=this;if(console.log("clickCheckIn -> event",e),void 0!==this.visitorUUIDForCheckin){var t=this.checkInOutService.createCheckInVisitor(this.placeUUID,this.visitorUUIDForCheckin).pipe(Object(m.a)((function(e){var t,n,o=e.data,c=e.errors,a=e.context,r=e.extensions;return console.log("clickCheckIn -> data",o,c,a,r),i.checkedInTimestampStringIdentifier=null===(t=null==o?void 0:o.insert_visit_one)||void 0===t?void 0:t.checked_in_at,i.checkedInDateTime=new Date(null===(n=null==o?void 0:o.insert_visit_one)||void 0===n?void 0:n.checked_in_at),console.log("clickCheckIn -> this.checkedInTimestampStringIdentifier",i.checkedInTimestampStringIdentifier,i.checkedInDateTime),e})));this.checkedInObs=t}}},{key:"clickCheckOut",value:function(e){var i=this;if(console.log("clickCheckOut -> event",e),console.log("placeUUID, visitorUUID, checkInTimestampString",this.placeUUID,this.visitorUUIDForCheckin,this.checkedInTimestampStringIdentifier),void 0!==this.placeUUID&&void 0!==this.visitorUUIDForCheckin&&void 0!==this.checkedInTimestampStringIdentifier){var t=this.checkInOutService.updateCheckOutVisitor(this.placeUUID,this.visitorUUIDForCheckin,this.checkedInTimestampStringIdentifier).pipe(Object(m.a)((function(e){var t,n;return console.log("clickCheckOut -> interceptResult",e),i.checkedOutDateTime=new Date(null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.update_visit_by_pk)||void 0===n?void 0:n.checked_out_at),e})));this.checkedOutObs=t}else console.log("Invalid details for checkout not stored.",this.placeUUID,this.visitorUUIDForCheckin,this.checkedInTimestampStringIdentifier)}}]),e}(),P.\u0275fac=function(e){return new(e||P)(h.Ib(b.a),h.Ib(p.a),h.Ib(l.a),h.Ib(f.a),h.Ib(D),h.Ib(C))},P.\u0275cmp=h.Cb({type:P,selectors:[["app-visitor"]],decls:71,vars:40,consts:[["src","/assets/images/les-logo-256px-min.png","alt","Placeholder-image",2,"width","12em"],[3,"formGroup","ngSubmit"],["f","ngForm"],["src","/assets/images/les-logo-1-min-4kB.png","alt","Placeholder-image"],[2,"padding-left","0.5em","max-width","fit-content"],[2,"padding-left","0.55em"],["name","people"],["name","timer-outline"],["position","floating"],["formControlName","visitor_first_name","type","text","required",""],["formControlName","visitor_last_name","type","text","required",""],["formControlName","visitor_phone","type","tel","size","12","required",""],["formControlName","visitor_email","type","text","required",""],["icon-only","","size","block",3,"disabled","click"],["name","person-add-outline","slot","icon-only"],["type","submit"],[4,"ngIf","ngIfElse"],["pendingCheckIn",""],["pendingCheckOut",""],["color","light"],[3,"disabled","click"],["name","log-in-outline"],[3,"disabled","color","click"],["name","log-out-outline"]],template:function(e,i){if(1&e&&(h.Nb(0,"ion-header"),h.Nb(1,"ion-toolbar"),h.Nb(2,"ion-title"),h.nc(3,"Checki\u2705"),h.Mb(),h.Mb(),h.Mb(),h.Nb(4,"ion-content"),h.Nb(5,"ion-card"),h.Nb(6,"ion-card-header"),h.nc(7,"Place"),h.Mb(),h.Nb(8,"ion-card-title"),h.nc(9," Logan Endoscopy Services "),h.Mb(),h.Jb(10,"img",0),h.Nb(11,"ion-card-subtitle"),h.nc(12),h.Yb(13,"async"),h.Mb(),h.Mb(),h.nc(14),h.Nb(15,"form",1,2),h.Vb("ngSubmit",(function(e){return i.submitForm(e)})),h.Nb(17,"ion-list"),h.Nb(18,"ion-list-header"),h.Nb(19,"ion-avatar"),h.Jb(20,"img",3),h.Mb(),h.Nb(21,"ion-label"),h.Nb(22,"h1",4),h.nc(23),h.Yb(24,"async"),h.Mb(),h.Nb(25,"h2",5),h.Jb(26,"ion-icon",6),h.nc(27),h.Yb(28,"async"),h.Jb(29,"ion-icon",7),h.nc(30),h.Yb(31,"async"),h.Mb(),h.Jb(32,"h3"),h.Mb(),h.Mb(),h.Nb(33,"ion-item"),h.Nb(34,"ion-label",8),h.nc(35," First name "),h.Mb(),h.Jb(36,"ion-input",9),h.Mb(),h.Nb(37,"ion-item"),h.Nb(38,"ion-label",8),h.nc(39," Last name "),h.Mb(),h.Jb(40,"ion-input",10),h.Mb(),h.Nb(41,"ion-item"),h.Nb(42,"ion-label",8),h.nc(43," Phone number "),h.Mb(),h.Jb(44,"ion-input",11),h.Mb(),h.Nb(45,"ion-item"),h.Nb(46,"ion-label",8),h.nc(47," Email address "),h.Mb(),h.Jb(48,"ion-input",12),h.Mb(),h.Mb(),h.Nb(49,"ion-button",13),h.Vb("click",(function(e){return i.submitForm(e)})),h.Jb(50,"ion-icon",14),h.Mb(),h.Jb(51,"button",15),h.Mb(),h.lc(52,M,4,7,"ng-container",16),h.lc(53,O,4,5,"ng-template",null,17,h.mc),h.Jb(55,"br"),h.lc(56,N,3,4,"ng-container",16),h.lc(57,w,4,6,"ng-template",null,18,h.mc),h.Jb(59,"br"),h.nc(60),h.Nb(61,"ion-text",19),h.nc(62),h.Yb(63,"json"),h.Yb(64,"async"),h.Yb(65,"json"),h.Yb(66,"async"),h.Yb(67,"json"),h.Yb(68,"async"),h.Yb(69,"json"),h.Yb(70,"async"),h.Mb(),h.Mb()),2&e){var t,n,o,c,a=h.hc(54),r=h.hc(58);h.yb(12),h.pc(" ",null==(t=h.Zb(13,16,i.placeDetails))?null:t.place_description," "),h.yb(2),h.pc(" ",i.visitorUUIDForCheckin," "),h.yb(1),h.dc("formGroup",i.visitorForm),h.yb(8),h.pc(" ",null==(n=h.Zb(24,18,i.placeDetails))?null:n.place_name," "),h.yb(4),h.pc(" ",null==(o=h.Zb(28,20,i.placeDetails))?null:o.place_capacity,"\xa0 "),h.yb(3),h.pc(" ",null==(c=h.Zb(31,22,i.placeDetails))?null:c.place_stay_estimate_minutes," "),h.yb(19),h.dc("disabled",i.visitorForm.invalid),h.yb(3),h.dc("ngIf",i.checkedInDateTime)("ngIfElse",a),h.yb(4),h.dc("ngIf",i.checkedOutDateTime)("ngIfElse",r),h.yb(4),h.pc(" ",i.visitorUUIDForCheckin," "),h.yb(2),h.sc(" | ",h.Zb(63,24,h.Zb(64,26,i.checkedInObs))," ",h.Zb(65,28,h.Zb(66,30,i.checkedOutObs))," | ",h.Zb(67,32,h.Zb(68,34,i.placeDetails))," Test 2 ",h.Zb(69,36,h.Zb(70,38,i.placeDeets))," ")}},directives:[u.l,u.z,u.y,u.k,u.g,u.h,u.j,u.i,l.n,l.j,l.e,u.t,u.u,u.b,u.s,u.m,u.o,u.n,u.E,l.i,l.c,l.l,u.e,s.l,u.x],pipes:[s.b,s.g,s.e],styles:[".submit-enter[_ngcontent-%COMP%]{position:absolute;visibility:hidden;left:-1000px}ion-icon[_ngcontent-%COMP%]{vertical-align:middle}"]}),P)}],E=((V=function e(){a(this,e)}).\u0275mod=h.Gb({type:V}),V.\u0275inj=h.Fb({factory:function(e){return new(e||V)},imports:[[b.i.forChild(S)],b.i]}),V),j=((T=function e(){a(this,e)}).\u0275mod=h.Gb({type:T}),T.\u0275inj=h.Fb({factory:function(e){return new(e||T)},imports:[[s.c,l.f,l.k,u.A,E]]}),T)}}])}();