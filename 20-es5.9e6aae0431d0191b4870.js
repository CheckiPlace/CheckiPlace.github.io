!function(){function i(){var e=c(['\n  mutation CreateVisitor(\n    $visitorInsertObject: visitor_insert_input! = { visitor_first_name: "", visitor_last_name: "", visitor_phone: "", visitor_email: "" }\n  ) {\n    insert_visitor_one(\n      object: $visitorInsertObject\n      on_conflict: { constraint: visitor_visitor_first_name_visitor_last_name_visitor_phone__key, update_columns: updated_at }\n    ) {\n      visitor_uuid\n    }\n  }\n']);return i=function(){return e},e}function e(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function t(i,t,n){return t&&e(i.prototype,t),n&&e(i,n),i}function n(){var i=c(['\n  query PlaceDetails($placeUUIDEquals: uuid! = "875b4319-5b1c-44ef-9950-bc6004c4f77a") {\n    place(where: { place_uuid: { _eq: $placeUUIDEquals } }, distinct_on: place_uuid) {\n      business_name\n      place_name\n      place_description\n      place_capacity\n      place_address\n      place_stay_estimate_minutes\n    }\n  }\n']);return n=function(){return i},i}function o(){var i=c(['\n  subscription PlaceVisitorsCurrentCount($placeUUIDEquals: uuid! = "") {\n    visit_aggregate(\n      where: {\n        _and: { place_uuid: { _eq: $placeUUIDEquals }, checked_out_at: { _is_null: true }, checked_in_at: { _is_null: false } }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n  }\n']);return o=function(){return i},i}function c(i,e){return e||(e=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(e)}}))}function a(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{CbZG:function(e,c,r){"use strict";r.r(c),r.d(c,"VisitorPageModule",(function(){return Z}));var s=r("SVse"),l=r("s7LF"),u=r("sZkV"),b=r("iInd"),d=r("pLZG"),v=r("lJxs"),p=function i(){return a(this,i),new l.d({visitor_first_name:new l.b("",[l.m.required,l.m.minLength(1)]),visitor_last_name:new l.b("",[l.m.required,l.m.minLength(1)]),visitor_phone:new l.b("",[l.m.required,l.m.minLength(10)]),visitor_email:new l.b("",l.m.compose([l.m.required,l.m.pattern("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$")]))})},m=r("8Y7J"),h=r("apZm"),f=r("ALmS"),g=r("nbgS");f.gql(o());var _,k,I=f.gql(n()),y=((_=function(){function i(e){a(this,i),this.apollo=e}return t(i,[{key:"getPlaceDetails",value:function(i){return this.apollo.query({query:I,variables:{placeUUIDEquals:i}})}}]),i}()).\u0275fac=function(i){return new(i||_)(m.Rb(g.b))},_.\u0275prov=m.Eb({token:_,factory:_.\u0275fac,providedIn:"root"}),_),U=f.gql(i()),D=((k=function(){function i(e){a(this,i),this.apollo=e}return t(i,[{key:"createVisitor",value:function(i){var e=i.visitor_first_name,t=i.visitor_last_name,n=i.visitor_phone,o=i.visitor_email;return this.apollo.mutate({mutation:U,variables:{visitorInsertObject:{visitor_first_name:e,visitor_last_name:t,visitor_phone:n,visitor_email:o}},errorPolicy:"all"})}}]),i}()).\u0275fac=function(i){return new(i||k)(m.Rb(g.b))},k.\u0275prov=m.Eb({token:k,factory:k.\u0275fac,providedIn:"root"}),k);function C(i,e){if(1&i&&(m.Lb(0),m.nc(1),m.Yb(2,"date"),m.Kb()),2&i){var t=m.Xb();m.yb(1),m.pc(" Thank you for checking in at ",m.Zb(2,1,t.checkedInDateTime)," ")}}function N(i,e){if(1&i){var t=m.Ob();m.Nb(0,"ion-button",20),m.Vb("click",(function(i){return m.ic(t),m.Xb().clickCheckIn(i)})),m.Jb(1,"ion-icon",21),m.nc(2),m.Yb(3,"date"),m.Mb()}if(2&i){var n=m.Xb();m.dc("disabled",void 0===n.visitorUUIDForCheckin),m.yb(2),m.pc(" Check in ",m.Zb(3,2,n.todayNow)," ")}}function M(i,e){if(1&i&&(m.Lb(0),m.nc(1),m.Yb(2,"date"),m.Kb()),2&i){var t=m.Xb();m.yb(1),m.pc(" Thank you for checking out at ",m.Zb(2,1,t.checkedInDateTime)," ")}}function O(i,e){if(1&i){var t=m.Ob();m.Nb(0,"ion-button",20),m.Vb("click",(function(i){return m.ic(t),m.Xb().clickCheckOut(i)})),m.Jb(1,"ion-icon",22),m.nc(2," Check out "),m.Mb()}if(2&i){var n=m.Xb();m.dc("disabled",void 0===n.visitorUUIDForCheckin)}}function w(i){console.log("VisitorPage:: getVisitorFieldsFromParamMap -> paramMap",i);var e=i.params;return console.log("VisitorPage:: extractHotlinkedVisitorParams -> unsafeExtractionObject",e),function(i){return{visitor_first_name:i.firstName,visitor_last_name:i.lastName,visitor_email:i.email,visitor_phone:i.phone}}(e)}var F,P,V,j=[{path:"",component:(F=function(){function i(e,t,n,o,c){var r,s,l=this;a(this,i),this.activatedRoute=e,this.formBuilder=t,this.checkInOutService=n,this.placeService=o,this.visitorService=c,this.todayNow=new Date,this.placeUUID=e.snapshot.paramMap.get("placeUUID"),console.log("VisitorPage -> constructor -> this.placeUUID",this.placeUUID),this.visitorForm=new p,this.visitorForm.valueChanges.subscribe((function(i){console.log("VisitorPage -> valueChanges",i,l.visitorForm)})),(r=e,s=r.paramMap,console.log("VisitorPage:: activatedRouteParamMap",s),s.pipe(Object(v.a)(w))).subscribe((function(i){console.log("VisitorPage -> constructor -> extractedVisitor",i),l.visitorForm.patchValue(i)}));var u=o.getPlaceDetails("875b4319-5b1c-44ef-9950-bc6004c4f77a");u.subscribe((function(i){var e=i.data,t=i.error,n=i.errors,o=i.loading,c=i.networkStatus,a=i.partial;console.log("VisitorPage:: getPlaceDetails() -> error",t,n,o,c,a),console.log("VisitorPage:: getPlaceDetails() -> data",e)}));var b=u.pipe(Object(d.a)((function(i){var e,t;return void 0!==(null===(t=null===(e=i.data)||void 0===e?void 0:e.place)||void 0===t?void 0:t[0])})),Object(v.a)((function(i){return i.data.place[0]})));this.placeDetails=b,this.placeDeets=o.getPlaceDetails("875b4319-5b1c-44ef-9950-bc6004c4f77a")}return t(i,[{key:"ngOnInit",value:function(){}},{key:"submitForm",value:function(i){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.visitorForm,n=t.invalid,o=t.value,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.visitorService;console.log("VisitorPage -> submitForm -> event",i),n||c.createVisitor(o).subscribe((function(i){var t,n;console.log("VisitorPage -> submitForm -> visitorResult",i),e.visitorUUIDForCheckin=null===(n=null===(t=i.data)||void 0===t?void 0:t.insert_visitor_one)||void 0===n?void 0:n.visitor_uuid}))}},{key:"clickCheckIn",value:function(i){var e=this;if(console.log("clickCheckIn -> event",i),void 0!==this.visitorUUIDForCheckin){var t=this.checkInOutService.createCheckInVisitor(this.placeUUID,this.visitorUUIDForCheckin).pipe(Object(v.a)((function(i){var t,n,o=i.data,c=i.errors,a=i.context,r=i.extensions;return console.log("clickCheckIn -> data",o,c,a,r),e.checkedInTimestampStringIdentifier=null===(t=null==o?void 0:o.insert_visit_one)||void 0===t?void 0:t.checked_in_at,e.checkedInDateTime=new Date(null===(n=null==o?void 0:o.insert_visit_one)||void 0===n?void 0:n.checked_in_at),console.log("clickCheckIn -> this.checkedInTimestampStringIdentifier",e.checkedInTimestampStringIdentifier,e.checkedInDateTime),i})));this.checkedInObs=t}}},{key:"clickCheckOut",value:function(i){var e=this;if(console.log("clickCheckOut -> event",i),console.log("placeUUID, visitorUUID, checkInTimestampString",this.placeUUID,this.visitorUUIDForCheckin,this.checkedInTimestampStringIdentifier),void 0!==this.placeUUID&&void 0!==this.visitorUUIDForCheckin&&void 0!==this.checkedInTimestampStringIdentifier){var t=this.checkInOutService.updateCheckOutVisitor(this.placeUUID,this.visitorUUIDForCheckin,this.checkedInTimestampStringIdentifier).pipe(Object(v.a)((function(i){var t,n;return console.log("clickCheckOut -> interceptResult",i),e.checkedOutDateTime=new Date(null===(n=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.update_visit_by_pk)||void 0===n?void 0:n.checked_out_at),i})));this.checkedOutObs=t}else console.log("Invalid details for checkout not stored.",this.placeUUID,this.visitorUUIDForCheckin,this.checkedInTimestampStringIdentifier)}}]),i}(),F.\u0275fac=function(i){return new(i||F)(m.Ib(b.a),m.Ib(l.a),m.Ib(h.a),m.Ib(y),m.Ib(D))},F.\u0275cmp=m.Cb({type:F,selectors:[["app-visitor"]],decls:69,vars:40,consts:[["src","/assets/images/les-logo-256px-min.png","alt","Placeholder-image",2,"width","12em"],[3,"formGroup","ngSubmit"],["f","ngForm"],["src","/assets/images/les-logo-1-min-4kB.png","alt","Placeholder-image"],[2,"padding-left","0.5em","max-width","fit-content"],[2,"padding-left","0.55em"],["name","people",2,"vertical-align","middle"],["name","timer-outline",2,"vertical-align","middle"],["position","floating"],["formControlName","visitor_first_name","type","text","required",""],["formControlName","visitor_last_name","type","text","required",""],["formControlName","visitor_phone","type","tel","size","12","required",""],["formControlName","visitor_email","type","text","required",""],["icon-only","","size","block",3,"disabled","click"],["name","person-add-outline","slot","icon-only"],["type","submit"],[4,"ngIf","ngIfElse"],["pendingCheckIn",""],["pendingCheckOut",""],["color","light"],[3,"disabled","click"],["name","log-in-outline"],["name","log-out-outline"]],template:function(i,e){if(1&i&&(m.Nb(0,"ion-header"),m.Nb(1,"ion-toolbar"),m.Nb(2,"ion-title"),m.nc(3,"Checki\u2705"),m.Mb(),m.Mb(),m.Mb(),m.Nb(4,"ion-content"),m.Nb(5,"ion-card"),m.Nb(6,"ion-card-header"),m.nc(7,"Place"),m.Mb(),m.Nb(8,"ion-card-title"),m.nc(9," Logan Endoscopy Services "),m.Mb(),m.Jb(10,"img",0),m.Nb(11,"ion-card-subtitle"),m.nc(12),m.Yb(13,"async"),m.Mb(),m.Mb(),m.nc(14),m.Nb(15,"form",1,2),m.Vb("ngSubmit",(function(i){return e.submitForm(i)})),m.Nb(17,"ion-list"),m.Nb(18,"ion-list-header"),m.Nb(19,"ion-avatar"),m.Jb(20,"img",3),m.Mb(),m.Nb(21,"ion-label"),m.Nb(22,"h1",4),m.nc(23),m.Yb(24,"async"),m.Mb(),m.Nb(25,"h2",5),m.Jb(26,"ion-icon",6),m.nc(27),m.Yb(28,"async"),m.Jb(29,"ion-icon",7),m.nc(30),m.Yb(31,"async"),m.Mb(),m.Jb(32,"h3"),m.Mb(),m.Mb(),m.Nb(33,"ion-item"),m.Nb(34,"ion-label",8),m.nc(35," First name "),m.Mb(),m.Jb(36,"ion-input",9),m.Mb(),m.Nb(37,"ion-item"),m.Nb(38,"ion-label",8),m.nc(39," Last name "),m.Mb(),m.Jb(40,"ion-input",10),m.Mb(),m.Nb(41,"ion-item"),m.Nb(42,"ion-label",8),m.nc(43," Phone number "),m.Mb(),m.Jb(44,"ion-input",11),m.Mb(),m.Nb(45,"ion-item"),m.Nb(46,"ion-label",8),m.nc(47," Email address "),m.Mb(),m.Jb(48,"ion-input",12),m.Mb(),m.Mb(),m.Nb(49,"ion-button",13),m.Vb("click",(function(i){return e.submitForm(i)})),m.Jb(50,"ion-icon",14),m.Mb(),m.Jb(51,"button",15),m.Mb(),m.lc(52,C,3,3,"ng-container",16),m.lc(53,N,4,4,"ng-template",null,17,m.mc),m.lc(55,M,3,3,"ng-container",16),m.lc(56,O,3,1,"ng-template",null,18,m.mc),m.nc(58),m.Yb(59,"json"),m.Yb(60,"async"),m.Yb(61,"json"),m.Yb(62,"async"),m.Nb(63,"ion-text",19),m.nc(64),m.Yb(65,"json"),m.Yb(66,"async"),m.Yb(67,"json"),m.Yb(68,"async"),m.Mb(),m.Mb()),2&i){var t,n,o,c,a=m.hc(54),r=m.hc(57);m.yb(12),m.pc(" ",null==(t=m.Zb(13,16,e.placeDetails))?null:t.place_description," "),m.yb(2),m.pc(" ",e.visitorUUIDForCheckin," "),m.yb(1),m.dc("formGroup",e.visitorForm),m.yb(8),m.pc(" ",null==(n=m.Zb(24,18,e.placeDetails))?null:n.place_name," "),m.yb(4),m.pc(" ",null==(o=m.Zb(28,20,e.placeDetails))?null:o.place_capacity,"\xa0 "),m.yb(3),m.pc(" ",null==(c=m.Zb(31,22,e.placeDetails))?null:c.place_stay_estimate_minutes," "),m.yb(19),m.dc("disabled",e.visitorForm.invalid),m.yb(3),m.dc("ngIf",e.checkedInDateTime)("ngIfElse",a),m.yb(3),m.dc("ngIf",e.checkedOutDateTime)("ngIfElse",r),m.yb(3),m.rc(" ",e.visitorUUIDForCheckin," | ",m.Zb(59,24,m.Zb(60,26,e.checkedInObs))," ",m.Zb(61,28,m.Zb(62,30,e.checkedOutObs))," "),m.yb(6),m.qc(" ",m.Zb(65,32,m.Zb(66,34,e.placeDetails))," Test 2 ",m.Zb(67,36,m.Zb(68,38,e.placeDeets))," ")}},directives:[u.l,u.z,u.y,u.k,u.g,u.h,u.j,u.i,l.n,l.j,l.e,u.t,u.u,u.b,u.s,u.m,u.o,u.n,u.E,l.i,l.c,l.l,u.e,s.l,u.x],pipes:[s.b,s.g,s.e],styles:[".submit-enter[_ngcontent-%COMP%]{position:absolute;visibility:hidden;left:-1000px}"]}),F)}],q=((V=function i(){a(this,i)}).\u0275mod=m.Gb({type:V}),V.\u0275inj=m.Fb({factory:function(i){return new(i||V)},imports:[[b.i.forChild(j)],b.i]}),V),Z=((P=function i(){a(this,i)}).\u0275mod=m.Gb({type:P}),P.\u0275inj=m.Fb({factory:function(i){return new(i||P)},imports:[[s.c,l.f,l.k,u.A,q]]}),P)}}])}();