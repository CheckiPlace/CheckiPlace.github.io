!function(){function i(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function t(i,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function e(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}function n(){var i=function(i,t){t||(t=i.slice(0));return Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(t)}}))}(['\n  subscription PlaceVisitors($placeUUIDEquals: uuid! = "") {\n    place(where: { place_uuid: { _eq: $placeUUIDEquals } }) {\n      visits_aggregate {\n        aggregate {\n          count(columns: visitor_uuid)\n        }\n      }\n      visits(order_by: { checked_out_at: desc_nulls_first, checked_in_at: desc_nulls_first }, limit: 200) {\n        checked_in_at\n        checked_out_at\n        visitor {\n          visitor_uuid\n          visitor_first_name\n          visitor_last_name\n          visitor_phone\n          visitor_email\n        }\n      }\n    }\n  }\n']);return n=function(){return i},i}(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{wFkS:function(t,c,o){"use strict";o.r(c),o.d(c,"VisitorsListPageModule",(function(){return Y}));var s,a=o("SVse"),r=o("s7LF"),l=o("sZkV"),u=o("iInd"),b=o("pLZG"),p=o("lJxs"),v=o("8Y7J"),f=o("apZm"),d=o("ALmS"),h=o("nbgS"),k=d.gql(n()),_=((s=function(){function t(e){i(this,t),this.apollo=e}return e(t,[{key:"getVisitorsByPlaceUUID",value:function(i){return this.apollo.subscribe({query:k,variables:{placeUUIDEquals:i}})}}]),t}()).\u0275fac=function(i){return new(i||s)(v.Rb(h.b))},s.\u0275prov=v.Eb({token:s,factory:s.\u0275fac,providedIn:"root"}),s);function y(i,t){if(1&i&&(v.Nb(0,"ion-list-header"),v.mc(1),v.Yb(2,"async"),v.Mb()),2&i){var e=v.Xb();v.yb(1),v.oc(" ",v.Zb(2,1,e.place)[0].visits_aggregate," ")}}function m(i,t){if(1&i){var e=v.Ob();v.Nb(0,"ion-item",2),v.Vb("click",(function(i){v.hc(e);var n=t.$implicit;return v.Xb().clickCheckOut(i,n.visitor.visitor_uuid,n.checked_in_at)})),v.mc(1),v.Yb(2,"date"),v.Yb(3,"date"),v.Mb()}if(2&i){var n=t.$implicit;v.yb(1),v.qc(" ",n.visitor.visitor_first_name," ",v.ac(2,3,n.checked_in_at,"HH:mm:ss")," ",v.ac(3,6,n.checked_out_at,"HH:mm:ss")," ")}}var g,U,I,O=[{path:"",component:(g=function(){function t(e,n,c){i(this,t),this.activatedRoute=e,this.checkInOutService=n,this.placeAdminService=c,this.placeUUID=e.snapshot.paramMap.get("placeUUID"),console.log("VisitorsListPage -> constructor -> this.placeUUID",this.placeUUID);var o=c.getVisitorsByPlaceUUID(this.placeUUID);this.placeVisitorsResult=o;var s=o.pipe(Object(b.a)((function(i){var t,e;return void 0!==(null===(e=null===(t=i.data)||void 0===t?void 0:t.place)||void 0===e?void 0:e[0])})),Object(p.a)((function(i){return i.data.place})));this.place=s;var a=s.pipe(Object(p.a)((function(i){return i[0].visits})));this.visits=a}return e(t,[{key:"ngOnInit",value:function(){}},{key:"clickCheckOut",value:function(i,t,e){console.log("clickCheckOut -> event",i),this.checkInOutService.updateCheckOutVisitor(this.placeUUID,t,e).subscribe((function(i){var t,e=i.data,n=i.errors,c=i.context,o=i.extensions;console.log("clickCheckOut -> data",e,n,c,o);var s=new Date(null===(t=null==e?void 0:e.update_visit_by_pk)||void 0===t?void 0:t.checked_out_at);console.log("VisitorsListPage -> clickCheckOut -> checkedOutDateTime",s)}))}}]),t}(),g.\u0275fac=function(i){return new(i||g)(v.Ib(u.a),v.Ib(f.a),v.Ib(_))},g.\u0275cmp=v.Cb({type:g,selectors:[["app-visitors-list"]],decls:20,vars:27,consts:[[4,"ngIf"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"]],template:function(i,t){1&i&&(v.Nb(0,"ion-header"),v.Nb(1,"ion-toolbar"),v.Nb(2,"ion-title"),v.mc(3,"Checki\u2705 place visitors"),v.Mb(),v.Mb(),v.Mb(),v.Nb(4,"ion-content"),v.Nb(5,"ion-list"),v.kc(6,y,3,3,"ion-list-header",0),v.Yb(7,"async"),v.Yb(8,"async"),v.Yb(9,"async"),v.Yb(10,"async"),v.kc(11,m,4,9,"ion-item",1),v.Yb(12,"async"),v.Mb(),v.mc(13),v.Yb(14,"json"),v.Yb(15,"async"),v.Yb(16,"json"),v.Yb(17,"async"),v.Yb(18,"json"),v.Yb(19,"async"),v.Mb()),2&i&&(v.yb(6),v.dc("ngIf",null!=t.place&&null!==v.Zb(7,5,t.place)&&void 0!==v.Zb(8,7,t.place)&&null!==v.Zb(9,9,t.place)[0]&&null!==v.Zb(10,11,t.place)[0]),v.yb(5),v.dc("ngForOf",v.Zb(12,13,t.visits)),v.yb(2),v.qc(" Test 1 ",v.Zb(14,15,v.Zb(15,17,t.placeVisitorsResult))," 2 ",v.Zb(16,19,v.Zb(17,21,t.place))," 3 ",v.Zb(18,23,v.Zb(19,25,t.visits)),"\n"))},directives:[l.l,l.w,l.v,l.k,l.q,a.l,a.k,l.r,l.o],pipes:[a.b,a.g,a.e],styles:[""]}),g)}],w=((I=function t(){i(this,t)}).\u0275mod=v.Gb({type:I}),I.\u0275inj=v.Fb({factory:function(i){return new(i||I)},imports:[[u.i.forChild(O)],u.i]}),I),Y=((U=function t(){i(this,t)}).\u0275mod=v.Gb({type:U}),U.\u0275inj=v.Fb({factory:function(i){return new(i||U)},imports:[[a.c,r.f,l.x,w]]}),U)}}])}();